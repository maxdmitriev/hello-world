<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Web Storage Test</title>
</head>
<body>

<form action="">
    <label for="genderMale">Male</label> <input id="genderMale" name="gender" value="male" type="radio" /><br />
    <label for="genderFemale">Female</label> <input id="genderFemale" name="gender" value="female" type="radio" /><br />
    <label for="settlementCity">City</label> <input id="settlementCity" name="settlement" value="city" type="checkbox" /><br />
    <label for="settlementVillage">Village</label> <input id="settlementVillage" name="settlement" value="village" type="checkbox" /><br />
    <label for="firstname">First Name</label> <input id="firstname" name="firstname" type="text" /><br />
    <label for="lastname">Last Name</label> <input id="lastname" name="lastname" type="text" /><br />
    <label for="message">Message</label> <textarea id="message" name="message"></textarea>
</form>

<div id="result"></div>

<script>
// Check browser support
if (typeof (Storage) !== 'undefined') {
    var form = document.querySelector('form'); // form
    var inputText = form.querySelectorAll('input[type=text]'); // all input type=text
    var textarea = form.querySelectorAll('textarea'); // all textarea elements
    var textElems = []; // empty array 

    inputText.forEach(function (el) {
        textElems.push(el); // add all input type=text to array 
    });

    textarea.forEach(function (el) {
        textElems.push(el); // add all textarea elements type=text to array 
    });
    
    textElems.forEach(function (el) {
        // Retrieve
        el.value = localStorage.getItem(el.id);
        
        // Store
        el.addEventListener('keyup', function () {
            localStorage.setItem(el.id, el.value);
            setTimeout(clearLocalStorage, 60000 * 3); // 60000 = 1min
        });
    });
    
    function clearLocalStorage() {
        localStorage.clear();
    }
}
</script>
</body>
</html>
